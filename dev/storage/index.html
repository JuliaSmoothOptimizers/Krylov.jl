<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Storage requirements · Krylov.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Krylov.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Krylov.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../processes/">Krylov processes</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Krylov methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../solvers/spd/">Hermitian positive definite linear systems</a></li><li><a class="tocitem" href="../solvers/sid/">Hermitian indefinite linear systems</a></li><li><a class="tocitem" href="../solvers/unsymmetric/">Non-Hermitian square linear systems</a></li><li><a class="tocitem" href="../solvers/ln/">Least-norm problems</a></li><li><a class="tocitem" href="../solvers/ls/">Least-squares problems</a></li><li><a class="tocitem" href="../solvers/as/">Adjoint systems</a></li><li><a class="tocitem" href="../solvers/sp_sqd/">Saddle-point and Hermitian quasi-definite systems</a></li><li><a class="tocitem" href="../solvers/gsp/">Generalized saddle-point and non-Hermitian partitioned systems</a></li></ul></li><li><a class="tocitem" href="../inplace/">In-place methods</a></li><li><a class="tocitem" href="../preconditioners/">Preconditioners</a></li><li class="is-active"><a class="tocitem" href>Storage requirements</a><ul class="internal"><li><a class="tocitem" href="#Theoretical-storage-requirements"><span>Theoretical storage requirements</span></a></li><li><a class="tocitem" href="#Practical-storage-requirements"><span>Practical storage requirements</span></a></li></ul></li><li><a class="tocitem" href="../gpu/">GPU support</a></li><li><a class="tocitem" href="../warm-start/">Warm-start</a></li><li><a class="tocitem" href="../factorization-free/">Factorization-free operators</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../tips/">Performance tips</a></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/cg/">CG</a></li><li><a class="tocitem" href="../examples/cg_lanczos_shift/">CG-LANCZOS-SHIFT</a></li><li><a class="tocitem" href="../examples/symmlq/">SYMMLQ</a></li><li><a class="tocitem" href="../examples/minres_qlp/">MINRES-QLP</a></li><li><a class="tocitem" href="../examples/tricg/">TriCG</a></li><li><a class="tocitem" href="../examples/trimr/">TriMR</a></li><li><a class="tocitem" href="../examples/bicgstab/">BICGSTAB</a></li><li><a class="tocitem" href="../examples/dqgmres/">DQGMRES</a></li><li><a class="tocitem" href="../examples/cgne/">CGNE</a></li><li><a class="tocitem" href="../examples/crmr/">CRMR</a></li><li><a class="tocitem" href="../examples/craig/">CRAIG</a></li><li><a class="tocitem" href="../examples/craigmr/">CRAIGMR</a></li><li><a class="tocitem" href="../examples/cgls/">CGLS</a></li><li><a class="tocitem" href="../examples/crls/">CRLS</a></li><li><a class="tocitem" href="../examples/lsqr/">LSQR</a></li><li><a class="tocitem" href="../examples/lsmr/">LSMR</a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Storage requirements</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Storage requirements</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSmoothOptimizers/Krylov.jl/blob/main/docs/src/storage.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><style>
.content table td {
    border-right-width: 1px;
}
.content table th {
    border-right-width: 1px;
}
.content table td:last-child {
    border-right-width: 0px;
}
.content table th:last-child {
    border-right-width: 0px;
}
html.theme--documenter-dark .content table td {
    border-right-width: 1px;
}
html.theme--documenter-dark .content table th {
    border-right-width: 1px;
}
html.theme--documenter-dark .content table td:last-child {
    border-right-width: 0px;
}
html.theme--documenter-dark .content table th:last-child {
    border-right-width: 0px;
}
</style><h1 id="storage-requirements"><a class="docs-heading-anchor" href="#storage-requirements">Storage requirements</a><a id="storage-requirements-1"></a><a class="docs-heading-anchor-permalink" href="#storage-requirements" title="Permalink"></a></h1><p>This section provides the storage requirements of all Krylov methods available in Krylov.jl.</p><h3 id="Notation"><a class="docs-heading-anchor" href="#Notation">Notation</a><a id="Notation-1"></a><a class="docs-heading-anchor-permalink" href="#Notation" title="Permalink"></a></h3><p>We denote by <span>$m$</span> and <span>$n$</span> the number of rows and columns of the linear problem. The memory parameter of DIOM, FOM, DQGMRES, GMRES, FGMRES and GPMR is <span>$k$</span>. The numbers of shifts of CG-LANCZOS-SHIFT is <span>$p$</span>.</p><h2 id="Theoretical-storage-requirements"><a class="docs-heading-anchor" href="#Theoretical-storage-requirements">Theoretical storage requirements</a><a id="Theoretical-storage-requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-storage-requirements" title="Permalink"></a></h2><p>The following tables provide the number of coefficients that must be allocated for each Krylov method. The coefficients have the same type as those that compose the linear problem we seek to solve. Each table summarizes the storage requirements of Krylov methods recommended to a specific linear problem.</p><h4 id="Hermitian-positive-definite-linear-systems"><a class="docs-heading-anchor" href="#Hermitian-positive-definite-linear-systems">Hermitian positive definite linear systems</a><a id="Hermitian-positive-definite-linear-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Hermitian-positive-definite-linear-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/spd/#Krylov.cg"><code>CG</code></a></th><th style="text-align: center"><a href="../solvers/spd/#Krylov.cr"><code>CR</code></a></th><th style="text-align: center"><a href="../solvers/spd/#Krylov.cg_lanczos"><code>CG-LANCZOS</code></a></th><th style="text-align: center"><a href="../solvers/spd/#Krylov.cg_lanczos_shift"><code>CG-LANCZOS-SHIFT</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$4n$</span></td><td style="text-align: center"><span>$5n$</span></td><td style="text-align: center"><span>$5n$</span></td><td style="text-align: center"><span>$3n + 2np + 5p$</span></td></tr></table><h4 id="Hermitian-indefinite-linear-systems"><a class="docs-heading-anchor" href="#Hermitian-indefinite-linear-systems">Hermitian indefinite linear systems</a><a id="Hermitian-indefinite-linear-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Hermitian-indefinite-linear-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/sid/#Krylov.symmlq"><code>SYMMLQ</code></a></th><th style="text-align: center"><a href="../solvers/sid/#Krylov.minres"><code>MINRES</code></a></th><th style="text-align: center"><a href="../solvers/sid/#Krylov.minres_qlp"><code>MINRES-QLP</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$5n$</span></td><td style="text-align: center"><span>$6n$</span></td><td style="text-align: center"><span>$6n$</span></td></tr></table><h4 id="Non-Hermitian-square-linear-systems"><a class="docs-heading-anchor" href="#Non-Hermitian-square-linear-systems">Non-Hermitian square linear systems</a><a id="Non-Hermitian-square-linear-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Non-Hermitian-square-linear-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.cgs"><code>CGS</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.bicgstab"><code>BICGSTAB</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.bilq"><code>BiLQ</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.qmr"><code>QMR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$6n$</span></td><td style="text-align: center"><span>$6n$</span></td><td style="text-align: center"><span>$8n$</span></td><td style="text-align: center"><span>$9n$</span></td></tr></table><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.diom"><code>DIOM</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.dqgmres"><code>DQGMRES</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$n(2k+1) + 2k - 1$</span></td><td style="text-align: center"><span>$n(2k+2) + 3k + 1$</span></td></tr></table><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.fom"><code>FOM</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.gmres"><code>GMRES</code></a></th><th style="text-align: center"><a href="../solvers/unsymmetric/#Krylov.fgmres"><code>FGMRES</code></a></th></tr><tr><td style="text-align: center">Storage<span>$\dfrac{}{}$</span></td><td style="text-align: center"><span>$\!n(2+k) +2k + \dfrac{k(k + 1)}{2}\!$</span></td><td style="text-align: center"><span>$\!n(2+k) + 3k + \dfrac{k(k + 1)}{2}\!$</span></td><td style="text-align: center"><span>$\!n(2+2k) + 3k + \dfrac{k(k + 1)}{2}\!$</span></td></tr></table><h4 id="Least-norm-problems"><a class="docs-heading-anchor" href="#Least-norm-problems">Least-norm problems</a><a id="Least-norm-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Least-norm-problems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/ln/#Krylov.usymlq"><code>USYMLQ</code></a></th><th style="text-align: center"><a href="../solvers/ln/#Krylov.cgne"><code>CGNE</code></a></th><th style="text-align: center"><a href="../solvers/ln/#Krylov.crmr"><code>CRMR</code></a></th><th style="text-align: center"><a href="../solvers/ln/#Krylov.lnlq"><code>LNLQ</code></a></th><th style="text-align: center"><a href="../solvers/ln/#Krylov.craig"><code>CRAIG</code></a></th><th style="text-align: center"><a href="../solvers/ln/#Krylov.craigmr"><code>CRAIGMR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$5n + 3m$</span></td><td style="text-align: center"><span>$3n + 2m$</span></td><td style="text-align: center"><span>$3n + 2m$</span></td><td style="text-align: center"><span>$3n + 4m$</span></td><td style="text-align: center"><span>$3n + 4m$</span></td><td style="text-align: center"><span>$4n + 5m$</span></td></tr></table><h4 id="Least-squares-problems"><a class="docs-heading-anchor" href="#Least-squares-problems">Least-squares problems</a><a id="Least-squares-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Least-squares-problems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/ls/#Krylov.usymqr"><code>USYMQR</code></a></th><th style="text-align: center"><a href="../solvers/ls/#Krylov.cgls"><code>CGLS</code></a></th><th style="text-align: center"><a href="../solvers/ls/#Krylov.crls"><code>CRLS</code></a></th><th style="text-align: center"><a href="../solvers/ls/#Krylov.lslq"><code>LSLQ</code></a></th><th style="text-align: center"><a href="../solvers/ls/#Krylov.lsqr"><code>LSQR</code></a></th><th style="text-align: center"><a href="../solvers/ls/#Krylov.lsmr"><code>LSMR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$6n + 3m$</span></td><td style="text-align: center"><span>$3n + 2m$</span></td><td style="text-align: center"><span>$4n + 3m$</span></td><td style="text-align: center"><span>$4n + 2m$</span></td><td style="text-align: center"><span>$4n + 2m$</span></td><td style="text-align: center"><span>$5n + 2m$</span></td></tr></table><h4 id="Adjoint-systems"><a class="docs-heading-anchor" href="#Adjoint-systems">Adjoint systems</a><a id="Adjoint-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Adjoint-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/as/#Krylov.bilqr"><code>BiLQR</code></a></th><th style="text-align: center"><a href="../solvers/as/#Krylov.trilqr"><code>TriLQR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$11n$</span></td><td style="text-align: center"><span>$6m + 5n$</span></td></tr></table><h4 id="Saddle-point-and-Hermitian-quasi-definite-systems"><a class="docs-heading-anchor" href="#Saddle-point-and-Hermitian-quasi-definite-systems">Saddle-point and Hermitian quasi-definite systems</a><a id="Saddle-point-and-Hermitian-quasi-definite-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Saddle-point-and-Hermitian-quasi-definite-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Methods</th><th style="text-align: center"><a href="../solvers/sp_sqd/#Krylov.tricg"><code>TriCG</code></a></th><th style="text-align: center"><a href="../solvers/sp_sqd/#Krylov.trimr"><code>TriMR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$6n + 6m$</span></td><td style="text-align: center"><span>$8n + 8m$</span></td></tr></table><h4 id="Generalized-saddle-point-and-non-Hermitian-partitioned-systems"><a class="docs-heading-anchor" href="#Generalized-saddle-point-and-non-Hermitian-partitioned-systems">Generalized saddle-point and non-Hermitian partitioned systems</a><a id="Generalized-saddle-point-and-non-Hermitian-partitioned-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Generalized-saddle-point-and-non-Hermitian-partitioned-systems" title="Permalink"></a></h4><table><tr><th style="text-align: center">Method</th><th style="text-align: center"><a href="../solvers/gsp/#Krylov.gpmr"><code>GPMR</code></a></th></tr><tr><td style="text-align: center">Storage</td><td style="text-align: center"><span>$(2+k)(n+m) + 2k^2 + 11k$</span></td></tr></table><h2 id="Practical-storage-requirements"><a class="docs-heading-anchor" href="#Practical-storage-requirements">Practical storage requirements</a><a id="Practical-storage-requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-storage-requirements" title="Permalink"></a></h2><p>Each method has its own <code>KrylovSolver</code> that contains all the storage needed by the method. In the REPL, the size in bytes of each attribute and the total amount of memory allocated by the solver are displayed when we show a <code>KrylovSolver</code>.</p><pre><code class="language-julia hljs">using Krylov

m = 5000
n = 12000
A = rand(Float64, m, n)
b = rand(Float64, m)
solver = LsmrSolver(A, b)
show(stdout, solver, show_stats=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────────────────┬──────────────────┬────────────────────┐
│        LsmrSolver│       nrows: 5000│        ncols: 12000│
├──────────────────┼──────────────────┼────────────────────┤
│Precision: Float64│ Architecture: CPU│Storage: 546.985 KiB│
├──────────────────┼──────────────────┼────────────────────┤
│         Attribute│              Type│                Size│
├──────────────────┼──────────────────┼────────────────────┤
│                 m│             Int64│             8 bytes│
│                 n│             Int64│             8 bytes│
│                 x│   Vector{Float64}│          93.750 KiB│
│                Nv│   Vector{Float64}│          93.750 KiB│
│               Aᴴu│   Vector{Float64}│          93.750 KiB│
│                 h│   Vector{Float64}│          93.750 KiB│
│              hbar│   Vector{Float64}│          93.750 KiB│
│                Mu│   Vector{Float64}│          39.062 KiB│
│                Av│   Vector{Float64}│          39.062 KiB│
│           err_vec│   Vector{Float64}│            40 bytes│
│             stats│LsmrStats{Float64}│            57 bytes│
└──────────────────┴──────────────────┴────────────────────┘</code></pre><p>If we want the total number of bytes used by the solver, we can call <code>nbytes = sizeof(solver)</code>.</p><pre><code class="language-julia hljs">nbytes = sizeof(solver)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">560113</code></pre><p>Thereafter, we can use <code>Base.format_bytes(nbytes)</code> to recover what is displayed in the REPL.</p><pre><code class="language-julia hljs">Base.format_bytes(nbytes)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;546.985 KiB&quot;</code></pre><p>To verify that we match the theoretical results, we just need to multiply the storage requirement of a method by the number of bytes associated to the precision of the linear problem. For instance, we need 4 bytes for the precision <code>Float32</code>, 8 bytes for precisions <code>Float64</code> and <code>ComplexF32</code>, and 16 bytes for the precision <code>ComplexF64</code>.</p><pre><code class="language-julia hljs">FC = Float64                            # precision of the least-squares problem
ncoefs_lsmr = 5*n + 2*m                 # number of coefficients
nbytes_lsmr = sizeof(FC) * ncoefs_lsmr  # number of bytes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">560000</code></pre><p>Therefore, you can check that you have enough memory in RAM to allocate a <code>KrylovSolver</code>.</p><pre><code class="language-julia hljs">free_nbytes = Sys.free_memory()
Base.format_bytes(free_nbytes)  # Total free memory in RAM in bytes.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;5.002 GiB&quot;</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>Beyond having faster operations, using low precisions, such as simple precision, allows to store more coefficients in RAM and solve larger linear problems.</li><li>In the file <a href="https://github.com/JuliaSmoothOptimizers/Krylov.jl/blob/main/test/test_allocations.jl">test_allocations.jl</a>, we use the macro <code>@allocated</code> to test that we match the expected storage requirement of each method with a tolerance of 2%.</li></ul></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../preconditioners/">« Preconditioners</a><a class="docs-footer-nextpage" href="../gpu/">GPU support »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 12 May 2023 14:16">Friday 12 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
